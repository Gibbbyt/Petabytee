"use strict";(()=>{var e={};e.id=2402,e.ids=[2402],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},90053:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{GET:()=>u,PUT:()=>p});var s=r(49303),i=r(88716),n=r(60670),o=r(87070),d=r(20728);async function u(e){try{let{searchParams:t}=new URL(e.url),r=t.get("status"),a=t.get("startDate"),s=t.get("endDate"),i=t.get("search"),n={};r&&(n.status=r.toUpperCase()),a&&s&&(n.createdAt={gte:new Date(a),lte:new Date(s)}),i&&(n.OR=[{orderNumber:{contains:i,mode:"insensitive"}},{user:{name:{contains:i,mode:"insensitive"}}},{user:{email:{contains:i,mode:"insensitive"}}}]);let u=(await d._.order.findMany({where:n,include:{user:{select:{id:!0,name:!0,email:!0,phone:!0}},items:{include:{product:!0}},timeline:{orderBy:{createdAt:"desc"}},invoice:!0},orderBy:{createdAt:"desc"}})).map(e=>({id:e.orderNumber,customerName:e.user.name,customerEmail:e.user.email,customerPhone:e.user.phone||"",products:e.items.map(e=>({name:e.product.name,quantity:e.quantity,price:e.price})),total:e.total,status:e.status.toLowerCase(),paymentStatus:e.paymentMethod?"paid":"pending",shippingAddress:e.shippingAddress||"",orderDate:e.createdAt.toISOString(),notes:e.notes||""}));return o.NextResponse.json(u)}catch(e){return console.error("Error fetching orders:",e),o.NextResponse.json([{id:"ORD-2024-001",customerName:"Ardit Gashi",customerEmail:"ardit.gashi@email.com",customerPhone:"+383 44 123 456",products:[{name:"Gaming Beast Pro",quantity:1,price:2899}],total:2899,status:"pending",paymentStatus:"paid",shippingAddress:"Rruga Agim Ramadani 15, 10000 Prishtina, Kosovo",orderDate:"2024-01-15T10:30:00Z",notes:"Customer requested RGB lighting customization"}])}}async function p(e){try{let{orderId:t,status:r,trackingNumber:a}=await e.json(),s=await d._.order.update({where:{orderNumber:t},data:{status:r.toUpperCase(),updatedAt:new Date}});return await d._.timeline.create({data:{entityType:"ORDER",entityId:s.id,title:`Order ${r}`,titleAl:`Porosia ${r}`,description:`Order status updated to ${r}`,descriptionAl:`Statusi i porosis\xeb u ndryshua n\xeb ${r}`,icon:{pending:"clock",processing:"package",shipped:"truck",delivered:"check-circle",cancelled:"x-circle"}[r.toLowerCase()]||"info"}}),o.NextResponse.json({success:!0,order:s})}catch(e){return console.error("Error updating order:",e),o.NextResponse.json({error:"Failed to update order"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:i.x.APP_ROUTE,page:"/api/admin/orders/route",pathname:"/api/admin/orders",filename:"route",bundlePath:"app/api/admin/orders/route"},resolvedPagePath:"/workspace/src/app/api/admin/orders/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:l,serverHooks:g}=c,h="/api/admin/orders/route";function y(){return(0,n.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},20728:(e,t,r)=>{r.d(t,{_:()=>s});let a=require("@prisma/client"),s=global.prisma||new a.PrismaClient({log:["query"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[9276,5972],()=>r(90053));module.exports=a})();